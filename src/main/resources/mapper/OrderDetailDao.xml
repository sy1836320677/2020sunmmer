<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.web.play.dao.OrderDetailDao">

    <resultMap type="com.web.play.entity.OrderDetail" id="OrderDetailMap">
        <result property="orderDetailId" column="order_detail_id" jdbcType="INTEGER"/>
        <result property="orderNumber" column="order_number" jdbcType="VARCHAR"/>
        <result property="orderId" column="order_id" jdbcType="VARCHAR"/>
        <result property="bookId" column="book_id" jdbcType="INTEGER"/>
        <result property="storeId" column="store_id" jdbcType="INTEGER"/>
        <result property="mount" column="mount" jdbcType="INTEGER"/>
        <result property="unitPrice" column="unit_price" jdbcType="NUMERIC"/>
        <result property="totalPrice" column="total_price" jdbcType="NUMERIC"/>
        <result property="postStatus" column="post_status" jdbcType="VARCHAR"/>
        <result property="deliveryTime" column="delivery_time" jdbcType="TIMESTAMP"/>
        <result property="receiveStatus" column="receive_status" jdbcType="VARCHAR"/>
        <result property="imageUrl" column="image_url" jdbcType="VARCHAR"/>
        <result property="bookName" column="book_name" jdbcType="VARCHAR"/>
        <result property="score" column="score" jdbcType="VARCHAR"/>
    </resultMap>

    <!--查询单个-->
    <select id="queryById" resultMap="OrderDetailMap">
        select
          order_detail_id, order_number, order_id, book_id, store_id, mount, unit_price, total_price, post_status, delivery_time, receive_status, image_url, book_name, score
        from books.order_detail
        where order_detail_id = #{orderDetailId}
    </select>

    <select id="queryByOrderId" resultMap="OrderDetailMap">
        select
          order_detail_id, order_number, order_id, book_id, store_id, mount, unit_price, total_price, post_status, delivery_time, receive_status, image_url, book_name, score
        from books.order_detail
        where order_id = #{orderId}
    </select>

    <!--查询指定行数据-->
    <select id="queryAllByLimit" resultMap="OrderDetailMap">
        select
          order_detail_id, order_number, order_id, book_id, store_id, mount, unit_price, total_price, post_status, delivery_time, receive_status, image_url, book_name, score
        from books.order_detail
        limit #{offset}, #{limit}
    </select>

    <select id="rebang" resultMap="OrderDetailMap">
        select
          book_id, count(book_id)
        from books.order_detail
        group by book_id
    </select>



    <!--通过实体作为筛选条件查询-->
    <select id="queryAll" resultMap="OrderDetailMap">
        select
          order_detail_id, order_number, order_id, book_id, store_id, mount, unit_price, total_price, post_status, delivery_time, receive_status, image_url, book_name, score
        from books.order_detail
        <where>
            <if test="orderDetailId != null">
                and order_detail_id = #{orderDetailId}
            </if>
            <if test="orderNumber != null and orderNumber != ''">
                and order_number = #{orderNumber}
            </if>
            <if test="orderId != null and orderId != ''">
                and order_id = #{orderId}
            </if>
            <if test="bookId != null">
                and book_id = #{bookId}
            </if>
            <if test="storeId != null">
                and store_id = #{storeId}
            </if>
            <if test="mount != null">
                and mount = #{mount}
            </if>
            <if test="unitPrice != null">
                and unit_price = #{unitPrice}
            </if>
            <if test="totalPrice != null">
                and total_price = #{totalPrice}
            </if>
            <if test="postStatus != null and postStatus != ''">
                and post_status = #{postStatus}
            </if>
            <if test="deliveryTime != null">
                and delivery_time = #{deliveryTime}
            </if>
            <if test="receiveStatus != null and receiveStatus != ''">
                and receive_status = #{receiveStatus}
            </if>
            <if test="imageUrl != null and imageUrl != ''">
                and image_url = #{imageUrl}
            </if>
            <if test="bookName != null and bookName != ''">
                and book_name = #{bookName}
            </if>
            <if test="score != null and score != ''">
                and score = #{score}
            </if>
        </where>
    </select>

    <!--新增所有列-->
    <insert id="insert" keyProperty="orderDetailId" useGeneratedKeys="true">
        insert into books.order_detail(order_number, order_id, book_id, store_id, mount, unit_price, total_price, post_status, delivery_time, receive_status, image_url, book_name, score)
        values (#{orderNumber}, #{orderId}, #{bookId}, #{storeId}, #{mount}, #{unitPrice}, #{totalPrice}, #{postStatus}, #{deliveryTime}, #{receiveStatus}, #{imageUrl}, #{bookName}, #{score})
    </insert>

    <!--通过主键修改数据-->
    <update id="update">
        update books.order_detail
        <set>
            <if test="orderNumber != null and orderNumber != ''">
                order_number = #{orderNumber},
            </if>
            <if test="orderId != null and orderId != ''">
                order_id = #{orderId},
            </if>
            <if test="bookId != null">
                book_id = #{bookId},
            </if>
            <if test="storeId != null">
                store_id = #{storeId},
            </if>
            <if test="mount != null">
                mount = #{mount},
            </if>
            <if test="unitPrice != null">
                unit_price = #{unitPrice},
            </if>
            <if test="totalPrice != null">
                total_price = #{totalPrice},
            </if>
            <if test="postStatus != null and postStatus != ''">
                post_status = #{postStatus},
            </if>
            <if test="deliveryTime != null">
                delivery_time = #{deliveryTime},
            </if>
            <if test="receiveStatus != null and receiveStatus != ''">
                receive_status = #{receiveStatus},
            </if>
            <if test="imageUrl != null and imageUrl != ''">
                image_url = #{imageUrl},
            </if>
            <if test="bookName != null and bookName != ''">
                book_name = #{bookName},
            </if>
            <if test="score != null and score != ''">
                score = #{score},
            </if>
        </set>
        where order_detail_id = #{orderDetailId}
    </update>

    <!--通过主键删除-->
    <delete id="deleteById">
        delete from books.order_detail where order_detail_id = #{orderDetailId}
    </delete>

</mapper>